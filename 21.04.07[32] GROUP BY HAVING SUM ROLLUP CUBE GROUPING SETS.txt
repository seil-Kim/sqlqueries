USE MagicCorp
GO

SELECT DNO, AVG(SALARY) AS DNOAVG
FROM EMPLOYEE
GROUP BY DNO


USE MagicCorp
GO

SELECT DNO, AVG(SALARY) AS DNOAVG
FROM EMPLOYEE
GROUP BY DNO
HAVING MAX(SALARY) > 500


USE MagicCorp
GO

SELECT DNO, JOB, SUM(SALARY) AS SUMSAL
FROM EMPLOYEE
GROUP BY DNO, JOB


USE MagicCorp
GO

SELECT DNO, JOB, SUM(SALARY) AS SUMSAL
FROM EMPLOYEE
GROUP BY DNO, JOB WITH ROLLUP


USE MagicCorp
GO

SELECT DNO, JOB, SUM(SALARY) AS SUMSAL
FROM EMPLOYEE
GROUP BY DNO, JOB WITH CUBE


USE MagicCorp
GO

SELECT DNO, JOB, SUM(SALARY) AS SUMSAL
FROM EMPLOYEE
GROUP BY GROUPING SETS( (DNO), (JOB))