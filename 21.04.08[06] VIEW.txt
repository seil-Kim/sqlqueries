USE MagicCorp
GO

CREATE VIEW EMP30
AS
SELECT *
FROM EMPLOYEE
WHERE DNO = 30


USE MagicCorp
GO

SELECT *
FROM EMP30
WHERE SALARY >= 50


USE MagicCorp
GO

CREATE VIEW EMPAVGSAL
AS
SELECT AVG(SALARY) AS SALAVG
FROM EMPLOYEE


USE MagicCorp
GO

SELECT DNAME, AVG_SAL
FROM (SELECT DNO, AVG(SALARY) AS AVG_SAL
		FROM EMPLOYEE
		GROUP BY DNO) AS S, DEPARTMENT D
WHERE S.DNO = D.DNO


USE MagicCorp
GO

WITH S(DNO, AVG_SAL)
AS(SELECT DNO, AVG(SALARY)
		FROM EMPLOYEE
		GROUP BY DNO)
SELECT DNAME, AVG_SAL
FROM S, DEPARTMENT D
WHERE S.DNO = D.DNO


USE MagicCorp
GO

EXEC sp_helptext EMP30