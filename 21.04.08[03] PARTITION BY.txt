USE MagicCorp
GO

SELECT ENAME, SALARY, DNO,
		RANK() OVER(PARTITION BY DNO ORDER BY SALARY DESC) AS RANK_DEPT
FROM EMPLOYEE


USE MagicCorp
GO

SELECT *
FROM(SELECT ENAME, SALARY, DNO,
		RANK() OVER(PARTITION BY DNO ORDER BY SALARY DESC) AS RANK_DEPT
		FROM EMPLOYEE) AS TEMP
WHERE RANK_DEPT = 2


USE MagicCorp
GO

SELECT DNO, AVG(SALARY) OVER (PARTITION BY DNO) AS AVG_SAL_DEPT
FROM EMPLOYEE


USE MagicCorp
GO

SELECT DISTINCT DNO, AVG(SALARY) OVER (PARTITION BY DNO) AS AVG_SAL_DEPT
FROM EMPLOYEE


USE MagicCorp
GO

SELECT DISTINCT DNO, FIRST_VALUE(SALARY)
			OVER(PARTITION BY DNO ORDER BY SALARY DESC) AS HIGHEST_SAL
FROM EMPLOYEE